import{a as V,b as $,c as v,d as f}from"./chunk-6J3ZOXLE.js";import{b as _}from"./chunk-PR5IPSC4.js";import{l as O,n as b,v as j,x as A,y as N}from"./chunk-XESAAIJC.js";import{B as l,D as a,E as o,F as x,J as D,K as y,L as h,T as m,U as u,V as P,Z as w,ca as E,da as U,fa as F,ga as g,ha as H,ib as M,j as S,ja as L,k as T,q as C,r,s as c,u as k,y as p}from"./chunk-3JAT2R2F.js";import"./chunk-I2Q4BQIR.js";import"./chunk-JZLQNAEF.js";import"./chunk-KZTU6K37.js";import"./chunk-TWFILCKL.js";import"./chunk-G3CV3VGG.js";import"./chunk-P64PGJAX.js";import"./chunk-GSVKY5FB.js";import"./chunk-OZG6UOOH.js";import"./chunk-4U6PRYVA.js";import"./chunk-BTS5SJXR.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{i as I}from"./chunk-D2OBB6XO.js";function R(e,i){if(e&1){let n=D();a(0,"div")(1,"a",2),y("click",function(){S(n);let s=h(3);return T(s.onLinkClick())}),m(2),o()()}if(e&2){let n=i.$implicit;r(),l("href",n,C),r(),P(" ",n," ")}}function B(e,i){if(e&1&&(a(0,"div"),p(1,R,3,2,"div",1),o()),e&2){let n=h(2);r(),l("ngForOf",n.content.links)}}function G(e,i){if(e&1&&(a(0,"div")(1,"h2"),m(2),o(),a(3,"p"),m(4),o(),p(5,B,2,1,"div",0),o()),e&2){let n=h();r(2),u(n.content.title),r(2),u(n.content.description),r(),l("ngIf",n.content.links&&n.content.links.length>0)}}function J(e,i){e&1&&(a(0,"div"),x(1,"ion-spinner",3),o())}var de=(()=>{let i=class i{constructor(t,s,d,q,z){this.userInteractionService=t,this.http=s,this.authService=d,this.httpService=q,this.route=z,this.page_id=null,this.content=null,this.user_id=null,this.startTime=0,this.time_spent=0}ngOnInit(){this.time_spent=0,this.pageLoadTime=Date.now(),console.log("\u{1F539} Page loaded at:",new Date(this.pageLoadTime).toLocaleTimeString()),this.timer&&clearInterval(this.timer),this.timer=setInterval(()=>{this.time_spent=Math.floor((Date.now()-this.pageLoadTime)/1e3),console.log("\u23F3 Time Spent:",this.time_spent)},1e3),this.user_id=this.authService.getUserId(),this.user_id?console.log("\u2705 User ID:",this.user_id):console.error("\u274C User ID is missing"),this.route.queryParams.subscribe(t=>{this.page_id=t.id?+t.id:null,this.page_id?(this.loadContent(),this.userInteractionService.startTracking(this.page_id)):console.error("\u274C No page ID found.")})}loadContent(){return I(this,null,function*(){if(!this.page_id){console.error("Page ID is not set.");return}try{console.log("Fetching content for page ID:",this.page_id);let t=yield this.httpService.getPageContent(this.page_id);this.content=t,console.log("Content loaded:",this.content)}catch(t){console.error("Error fetching page content:",t)}})}onLinkClick(){if(this.page_id&&this.user_id){console.log("\u2705 Calling recordClick() with:",this.page_id,this.user_id,this.time_spent,this.userInteractionService.clicks+1);let t=this.userInteractionService.recordClick(this.page_id,this.user_id,this.time_spent,++this.userInteractionService.clicks);console.log("\u{1F4CC} recordClick() returned:",t)}else console.error("\u274C Page ID or User ID is missing!")}ngOnDestroy(){clearInterval(this.timer),console.log(`Time spent on the page: ${this.time_spent} seconds`),this.page_id&&this.user_id?this.userInteractionService.stopTracking(this.user_id):console.error("Page ID or User ID is missing!"),console.log("ngOnDestroy triggered")}};i.\u0275fac=function(s){return new(s||i)(c(f),c(g),c(_),c(v),c(L))},i.\u0275cmp=k({type:i,selectors:[["app-treatment"]],features:[w([g,$,V,v,f,_])],decls:7,vars:2,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],["target","_blank","rel","noopener noreferrer",3,"click","href"],["name","dots"]],template:function(s,d){s&1&&(a(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),m(3,"Testing Page"),o()()(),a(4,"ion-content"),p(5,G,6,3,"div",0)(6,J,2,0,"div",0),o()),s&2&&(r(5),l("ngIf",d.content),r(),l("ngIf",!d.content))},dependencies:[j,O,b,A,H,N,F,E,U,M],encapsulation:2});let e=i;return e})();export{de as TreatmentPage};
