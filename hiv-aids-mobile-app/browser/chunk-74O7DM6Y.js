import{a as $,b as q,c as B,d as u}from"./chunk-6J3ZOXLE.js";import{b as f}from"./chunk-PR5IPSC4.js";import{A as W,j as V,l as E,n as U,o as F,p as j,q as N,v as A,x as R,y as z}from"./chunk-XESAAIJC.js";import{B as a,D as r,E as c,F as h,J as y,K as S,L as m,T as l,U as _,V as P,Z as b,ca as w,da as M,fa as O,ga as T,ha as D,ib as H,j as I,ja as L,k as x,q as C,r as o,s as d,u as k,y as p}from"./chunk-3JAT2R2F.js";import"./chunk-I2Q4BQIR.js";import"./chunk-JZLQNAEF.js";import"./chunk-KZTU6K37.js";import"./chunk-TWFILCKL.js";import"./chunk-G3CV3VGG.js";import"./chunk-P64PGJAX.js";import"./chunk-GSVKY5FB.js";import"./chunk-OZG6UOOH.js";import"./chunk-4U6PRYVA.js";import"./chunk-BTS5SJXR.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{i as v}from"./chunk-D2OBB6XO.js";function K(e,n){e&1&&(r(0,"div",4),h(1,"ion-spinner",5),r(2,"p"),l(3,"Loading resources..."),c()())}function Q(e,n){if(e&1&&(r(0,"ion-chip",13)(1,"ion-label"),l(2),c()()),e&2){let i=m(2);o(2),_(i.content.category)}}function X(e,n){if(e&1){let i=y();r(0,"ion-item",17),h(1,"ion-icon",18),r(2,"a",19),S("click",function(){I(i);let s=m(3);return x(s.onLinkClick())}),l(3),c()()}if(e&2){let i=n.$implicit,t=m(3);o(2),a("href",i,C),o(),P(" ",t.getLinkDisplayName(i)," ")}}function Y(e,n){if(e&1&&(r(0,"div",14)(1,"h3"),l(2,"Helpful Resources"),c(),r(3,"ion-list",15),p(4,X,4,2,"ion-item",16),c()()),e&2){let i=m(2);o(4),a("ngForOf",i.content.links)}}function Z(e,n){e&1&&h(0,"div",20)}function ee(e,n){if(e&1&&(r(0,"div",6)(1,"div",7)(2,"h1"),l(3),c(),p(4,Q,3,1,"ion-chip",8),c(),r(5,"div",9)(6,"p",10),l(7),c()(),p(8,Y,5,1,"div",11)(9,Z,1,0,"div",12),c()),e&2){let i=m();o(3),_(i.content.title),o(),a("ngIf",i.content.category),o(3),_(i.content.description),o(),a("ngIf",i.content.links==null?null:i.content.links.length),o(),a("ngIf",i.user_id)}}var ue=(()=>{let n=class n{constructor(t,s,g,G,J){this.userInteractionService=t,this.http=s,this.authService=g,this.httpService=G,this.route=J,this.page_id=null,this.content=null,this.user_id=null,this.startTime=0,this.time_spent=0}ngOnInit(){this.time_spent=0,this.pageLoadTime=Date.now(),console.log("\u{1F539} Page loaded at:",new Date(this.pageLoadTime).toLocaleTimeString()),this.timer&&clearInterval(this.timer),this.timer=setInterval(()=>{this.time_spent=Math.floor((Date.now()-this.pageLoadTime)/1e3),console.log("\u23F3 Time Spent:",this.time_spent)},1e3),this.user_id=this.authService.getUserId(),this.user_id?console.log("\u2705 User ID:",this.user_id):console.error("\u274C User ID is missing"),this.route.queryParams.subscribe(t=>{this.page_id=t.id?+t.id:null,this.page_id?(this.loadContent(),this.userInteractionService.startTracking(this.page_id)):console.error("\u274C No page ID found.")})}loadContent(){return v(this,null,function*(){if(!this.page_id){console.error("Page ID is not set.");return}try{console.log("Fetching content for page ID:",this.page_id);let t=yield this.httpService.getPageContent(this.page_id);this.content=t,console.log("Content loaded:",this.content)}catch(t){console.error("Error fetching page content:",t)}})}onLinkClick(){if(this.page_id&&this.user_id){console.log("\u2705 Calling recordClick() with:",this.page_id,this.user_id,this.time_spent,this.userInteractionService.clicks+1);let t=this.userInteractionService.recordClick(this.page_id,this.user_id,this.time_spent,++this.userInteractionService.clicks);console.log("\u{1F4CC} recordClick() returned:",t)}else console.error("\u274C Page ID or User ID is missing!")}ionViewWillLeave(){clearInterval(this.timer),console.log(`\u{1F680} ionViewWillLeave: Time spent on page ${this.time_spent} seconds`),this.page_id&&this.user_id?this.userInteractionService.stopTracking(this.user_id):console.error("\u274C Page ID or User ID is missing!")}ngOnDestroy(){console.log("ngOnDestroy triggered")}getLinkDisplayName(t){try{return new URL(t).hostname.replace("www.","")||t}catch{return t}}};n.\u0275fac=function(s){return new(s||n)(d(u),d(T),d(f),d(B),d(L))},n.\u0275cmp=k({type:n,selectors:[["app-hiv"]],features:[b([q,$,f,u])],decls:7,vars:2,consts:[["color","primary"],[1,"ion-padding"],["class","loading-container",4,"ngIf"],["class","content-container",4,"ngIf"],[1,"loading-container"],["name","crescent","color","primary"],[1,"content-container"],[1,"header"],["color","tertiary",4,"ngIf"],[1,"description"],[1,"content"],["class","links-section",4,"ngIf"],["class","stats",4,"ngIf"],["color","tertiary"],[1,"links-section"],["lines","none"],["class","link-item",4,"ngFor","ngForOf"],[1,"link-item"],["name","link-outline","slot","start","color","primary"],["target","_blank","rel","noopener noreferrer",1,"resource-link",3,"click","href"],[1,"stats"]],template:function(s,g){s&1&&(r(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),l(3,"HIV Testing Information"),c()()(),r(4,"ion-content",1),p(5,K,4,0,"div",2)(6,ee,10,5,"div",3),c()),s&2&&(o(5),a("ngIf",!g.content),o(),a("ngIf",g.content))},dependencies:[E,U,R,A,D,V,j,N,W,F,z,O,w,M,H],styles:["ion-content[_ngcontent-%COMP%]{--background: #f8f9fa}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:50vh;text-align:center;color:var(--ion-color-medium)}.content-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}.header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:var(--ion-color-primary);margin-bottom:.5rem}.description[_ngcontent-%COMP%]{background:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 2px 8px #0000000d;margin-bottom:2rem;line-height:1.6}.content[_ngcontent-%COMP%]{color:#000}.links-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--ion-color-dark);font-weight:600;margin-bottom:1rem}.link-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;margin-bottom:.5rem;background:#fff;border-radius:8px;box-shadow:0 2px 6px #0000000d}.resource-link[_ngcontent-%COMP%]{color:var(--ion-color-primary);text-decoration:none;padding:1rem;display:block;width:100%}.resource-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.stats[_ngcontent-%COMP%]{margin-top:2rem;text-align:right;font-size:.9rem}"]});let e=n;return e})();export{ue as HIVPage};
